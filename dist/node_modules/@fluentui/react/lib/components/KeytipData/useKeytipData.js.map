{"version":3,"file":"useKeytipData.js","sources":["../../../../../../../node_modules/@fluentui/react/lib/components/KeytipData/useKeytipData.js"],"sourcesContent":["import { __assign, __spreadArray } from \"tslib\";\nimport * as React from 'react';\nimport { useConst, useIsomorphicLayoutEffect, usePrevious } from '@fluentui/react-hooks';\nimport { mergeAriaAttributeValues } from '../../Utilities';\nimport { KeytipManager, mergeOverflows, sequencesToID, getAriaDescribedBy } from '../../utilities/keytips/index';\n/**\n * Hook that creates attributes for components which are enabled with Keytip.\n */\nexport function useKeytipData(options) {\n    var uniqueId = React.useRef();\n    var keytipProps = options.keytipProps\n        ? __assign({ disabled: options.disabled }, options.keytipProps) : undefined;\n    var keytipManager = useConst(KeytipManager.getInstance());\n    var prevOptions = usePrevious(options);\n    // useLayoutEffect used to strictly emulate didUpdate/didMount behavior\n    useIsomorphicLayoutEffect(function () {\n        if (uniqueId.current &&\n            keytipProps &&\n            ((prevOptions === null || prevOptions === void 0 ? void 0 : prevOptions.keytipProps) !== options.keytipProps || (prevOptions === null || prevOptions === void 0 ? void 0 : prevOptions.disabled) !== options.disabled)) {\n            keytipManager.update(keytipProps, uniqueId.current);\n        }\n    });\n    useIsomorphicLayoutEffect(function () {\n        // Register Keytip in KeytipManager\n        if (keytipProps) {\n            uniqueId.current = keytipManager.register(keytipProps);\n        }\n        return function () {\n            // Unregister Keytip in KeytipManager\n            keytipProps && keytipManager.unregister(keytipProps, uniqueId.current);\n        };\n        // this is meant to run only at mount, and updates are handled separately\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    var nativeKeytipProps = {\n        ariaDescribedBy: undefined,\n        keytipId: undefined,\n    };\n    if (keytipProps) {\n        nativeKeytipProps = getKeytipData(keytipManager, keytipProps, options.ariaDescribedBy);\n    }\n    return nativeKeytipProps;\n}\n/**\n * Gets the aria- and data- attributes to attach to the component\n * @param keytipProps - options for Keytip\n * @param describedByPrepend - ariaDescribedBy value to prepend\n */\nfunction getKeytipData(keytipManager, keytipProps, describedByPrepend) {\n    // Add the parent overflow sequence if necessary\n    var newKeytipProps = keytipManager.addParentOverflow(keytipProps);\n    // Construct aria-describedby and data-ktp-id attributes\n    var ariaDescribedBy = mergeAriaAttributeValues(describedByPrepend, getAriaDescribedBy(newKeytipProps.keySequences));\n    var keySequences = __spreadArray([], newKeytipProps.keySequences, true);\n    if (newKeytipProps.overflowSetSequence) {\n        keySequences = mergeOverflows(keySequences, newKeytipProps.overflowSetSequence);\n    }\n    var keytipId = sequencesToID(keySequences);\n    return {\n        ariaDescribedBy: ariaDescribedBy,\n        keytipId: keytipId,\n    };\n}\n//# sourceMappingURL=useKeytipData.js.map"],"names":["useKeytipData","options","uniqueId","React","keytipProps","__assign","keytipManager","useConst","KeytipManager","prevOptions","usePrevious","useIsomorphicLayoutEffect","nativeKeytipProps","getKeytipData","describedByPrepend","newKeytipProps","ariaDescribedBy","mergeAriaAttributeValues","getAriaDescribedBy","keySequences","__spreadArray","mergeOverflows","keytipId","sequencesToID"],"mappings":";;;;;;;;AAQO,SAASA,EAAcC,GAAS;AACnC,MAAIC,IAAWC,EAAM,UACjBC,IAAcH,EAAQ,cACpBI,EAAS,EAAE,UAAUJ,EAAQ,SAAU,GAAEA,EAAQ,WAAW,IAAI,QAClEK,IAAgBC,EAASC,EAAc,YAAa,CAAA,GACpDC,IAAcC,EAAYT,CAAO;AAErC,EAAAU,EAA0B,WAAY;AAClC,IAAIT,EAAS,WACTE,OACEK,KAAgB,OAAiC,SAASA,EAAY,iBAAiBR,EAAQ,gBAAgBQ,KAAgB,OAAiC,SAASA,EAAY,cAAcR,EAAQ,aAC7MK,EAAc,OAAOF,GAAaF,EAAS,OAAO;AAAA,EAE9D,CAAK,GACDS,EAA0B,WAAY;AAElC,WAAIP,MACAF,EAAS,UAAUI,EAAc,SAASF,CAAW,IAElD,WAAY;AAEf,MAAAA,KAAeE,EAAc,WAAWF,GAAaF,EAAS,OAAO;AAAA,IACjF;AAAA,EAGK,GAAE,CAAE,CAAA;AACL,MAAIU,IAAoB;AAAA,IACpB,iBAAiB;AAAA,IACjB,UAAU;AAAA,EAClB;AACI,SAAIR,MACAQ,IAAoBC,EAAcP,GAAeF,GAAaH,EAAQ,eAAe,IAElFW;AACX;AAMA,SAASC,EAAcP,GAAeF,GAAaU,GAAoB;AAEnE,MAAIC,IAAiBT,EAAc,kBAAkBF,CAAW,GAE5DY,IAAkBC,EAAyBH,GAAoBI,EAAmBH,EAAe,YAAY,CAAC,GAC9GI,IAAeC,EAAc,CAAA,GAAIL,EAAe,cAAc,EAAI;AACtE,EAAIA,EAAe,wBACfI,IAAeE,EAAeF,GAAcJ,EAAe,mBAAmB;AAElF,MAAIO,IAAWC,EAAcJ,CAAY;AACzC,SAAO;AAAA,IACH,iBAAiBH;AAAA,IACjB,UAAUM;AAAA,EAClB;AACA;","x_google_ignoreList":[0]}