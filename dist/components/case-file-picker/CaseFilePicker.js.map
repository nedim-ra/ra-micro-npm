{"version":3,"file":"CaseFilePicker.js","sources":["../../../lib/components/case-file-picker/CaseFilePicker.tsx"],"sourcesContent":["import {\r\n  ComboBox,\r\n  IComboBox,\r\n  IComboBoxOption,\r\n  IComboBoxProps,\r\n  IComboBoxStyles,\r\n} from \"@fluentui/react\";\r\nimport React, { FormEvent } from \"react\";\r\nimport { CaseFile, CaseFileUtils } from \"../../main.ts\";\r\nimport CaseFileService from \"../../services/case-file-service.ts\";\r\n\r\ninterface CaseControlProps extends Partial<IComboBoxProps> {\r\n  label: string;\r\n  handleComboBoxChange: (options: IComboBoxOption[]) => void;\r\n  showErrorMessage: (errorMsg: string) => void;\r\n  styles: Partial<IComboBoxStyles>;\r\n  selectedOption: IComboBoxOption;\r\n  caseOptions: IComboBoxOption[];\r\n  setSelectedOption: (option: IComboBoxOption) => void;\r\n  disabled?: boolean;\r\n  getDomain: () => Promise<string>;\r\n  getCase: (domain: string, numValue: string) => Promise<CaseFile[]>;\r\n}\r\n\r\nfunction CaseFilePicker({\r\n  label,\r\n  handleComboBoxChange,\r\n  showErrorMessage,\r\n  styles,\r\n  selectedOption,\r\n  caseOptions,\r\n  setSelectedOption,\r\n  disabled = false,\r\n  // TEMP: getDomain will be handled differently\r\n  getDomain,\r\n  getCase,\r\n}: CaseControlProps): JSX.Element {\r\n  const comboBoxRef = React.useRef<IComboBox>(null);\r\n  const initialStyle = Object.assign(styles || {});\r\n\r\n  // Update styles to include the background color\r\n  const comboBoxStyles: Partial<IComboBoxStyles> = {\r\n    ...initialStyle, // Spread existing styles\r\n    root: {\r\n      ...initialStyle.root, // Spread existing container styles\r\n      backgroundColor: \"#ffffd0\", // Add the background color\r\n    },\r\n    input: {\r\n      ...initialStyle.input, // Spread existing container styles\r\n      backgroundColor: \"#ffffd0\",\r\n    },\r\n  };\r\n\r\n  const onChangeValue = async (input: string) => {\r\n    const numValue = input.replace(/\\D/g, \"\");\r\n    const formattedValue = CaseFileUtils.formatCaseYear(numValue);\r\n    const domain = await getDomain();\r\n    let caseData = await getCase(domain, numValue);\r\n\r\n    if (caseData && caseData.length > 0) {\r\n      const fullText = `${formattedValue} - ${caseData[0].akt_name}`;\r\n      const options = [{ key: numValue, text: fullText }];\r\n      comboBoxRef?.current?.focus(true);\r\n      handleComboBoxChange(options);\r\n    } else {\r\n      caseData = await CaseFileService.getCaseByName(domain, input);\r\n      if (!caseData || caseData.length === 0) {\r\n        showErrorMessage(\"Es gibt keine Suchergebnisse\"); // TEMP\r\n      } else {\r\n        const options = caseData.map((item) => ({\r\n          key: CaseFileUtils.formatCaseYear(item.akt_nr || \"\"),\r\n          text: `${CaseFileUtils.formatCaseYear(item.akt_nr || \"\")} - ${item.akt_name}`,\r\n        }));\r\n        comboBoxRef?.current?.focus(true);\r\n        handleComboBoxChange(options);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ComboBox\r\n      componentRef={comboBoxRef}\r\n      allowFreeform\r\n      label={label}\r\n      onChange={(\r\n        event: FormEvent<IComboBox>,\r\n        _option,\r\n        _index,\r\n        value?: string\r\n      ) => {\r\n        if (event && value) {\r\n          onChangeValue(value);\r\n        }\r\n      }}\r\n      onItemClick={(_, option?: IComboBoxOption) => {\r\n        if (option) {\r\n          setSelectedOption(option);\r\n        }\r\n      }}\r\n      styles={comboBoxStyles}\r\n      options={caseOptions}\r\n      selectedKey={selectedOption ? selectedOption.key : undefined}\r\n      useComboBoxAsMenuWidth\r\n      disabled={disabled}\r\n    />\r\n  );\r\n}\r\n\r\nCaseFilePicker.defaultProps = {\r\n  disabled: false,\r\n};\r\n\r\nexport default CaseFilePicker;\r\n"],"names":["CaseFilePicker","label","handleComboBoxChange","showErrorMessage","styles","selectedOption","caseOptions","setSelectedOption","disabled","getDomain","getCase","comboBoxRef","React","initialStyle","comboBoxStyles","onChangeValue","input","numValue","formattedValue","CaseFileUtils","domain","caseData","fullText","options","_a","CaseFileService","item","_b","jsx","ComboBox","event","_option","_index","value","_","option"],"mappings":";;;;;;AAwBA,SAASA,EAAe;AAAA,EACtB,OAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,QAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,aAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,UAAAC,IAAW;AAAA;AAAA,EAEX,WAAAC;AAAA,EACA,SAAAC;AACF,GAAkC;AAC1B,QAAAC,IAAcC,EAAM,OAAkB,IAAI,GAC1CC,IAAe,OAAO,OAAOT,KAAU,CAAE,CAAA,GAGzCU,IAA2C;AAAA,IAC/C,GAAGD;AAAA;AAAA,IACH,MAAM;AAAA,MACJ,GAAGA,EAAa;AAAA;AAAA,MAChB,iBAAiB;AAAA;AAAA,IACnB;AAAA,IACA,OAAO;AAAA,MACL,GAAGA,EAAa;AAAA;AAAA,MAChB,iBAAiB;AAAA,IACnB;AAAA,EAAA,GAGIE,IAAgB,OAAOC,MAAkB;;AAC7C,UAAMC,IAAWD,EAAM,QAAQ,OAAO,EAAE,GAClCE,IAAiBC,EAAc,eAAeF,CAAQ,GACtDG,IAAS,MAAMX;AACrB,QAAIY,IAAW,MAAMX,EAAQU,GAAQH,CAAQ;AAEzC,QAAAI,KAAYA,EAAS,SAAS,GAAG;AACnC,YAAMC,IAAW,GAAGJ,CAAc,MAAMG,EAAS,CAAC,EAAE,QAAQ,IACtDE,IAAU,CAAC,EAAE,KAAKN,GAAU,MAAMK,GAAU;AACrC,OAAAE,IAAAb,KAAA,gBAAAA,EAAA,YAAA,QAAAa,EAAS,MAAM,KAC5BtB,EAAqBqB,CAAO;AAAA,IAAA,WAE5BF,IAAW,MAAMI,EAAgB,cAAcL,GAAQJ,CAAK,GACxD,CAACK,KAAYA,EAAS,WAAW;AACnC,MAAAlB,EAAiB,8BAA8B;AAAA,SAC1C;AACL,YAAMoB,IAAUF,EAAS,IAAI,CAACK,OAAU;AAAA,QACtC,KAAKP,EAAc,eAAeO,EAAK,UAAU,EAAE;AAAA,QACnD,MAAM,GAAGP,EAAc,eAAeO,EAAK,UAAU,EAAE,CAAC,MAAMA,EAAK,QAAQ;AAAA,MAC3E,EAAA;AACW,OAAAC,IAAAhB,KAAA,gBAAAA,EAAA,YAAA,QAAAgB,EAAS,MAAM,KAC5BzB,EAAqBqB,CAAO;AAAA,IAC9B;AAAA,EACF;AAIA,SAAAK,gBAAAA,EAAA;AAAA,IAACC;AAAA,IAAA;AAAA,MACC,cAAclB;AAAA,MACd,eAAa;AAAA,MACb,OAAAV;AAAA,MACA,UAAU,CACR6B,GACAC,GACAC,GACAC,MACG;AACH,QAAIH,KAASG,KACXlB,EAAckB,CAAK;AAAA,MAEvB;AAAA,MACA,aAAa,CAACC,GAAGC,MAA6B;AAC5C,QAAIA,KACF5B,EAAkB4B,CAAM;AAAA,MAE5B;AAAA,MACA,QAAQrB;AAAA,MACR,SAASR;AAAA,MACT,aAAaD,IAAiBA,EAAe,MAAM;AAAA,MACnD,wBAAsB;AAAA,MACtB,UAAAG;AAAA,IAAA;AAAA,EAAA;AAGN;AAEAR,EAAe,eAAe;AAAA,EAC5B,UAAU;AACZ;"}